<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Employee Attendance Processor</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f6f6f6;
        padding: 20px;
    }
    .container {
        max-width: 500px;
        margin: auto;
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0px 3px 10px rgba(0,0,0,0.2);
    }
    h2 { text-align: center; }
    label { font-weight: bold; margin-top: 10px; display: block; }
    input, button {
        width: 100%;
        padding: 10px;
        margin-top: 5px;
        border-radius: 5px;
        border: 1px solid #ddd;
        font-size: 15px;
    }
    button {
        background: #0066ff;
        color: white;
        cursor: pointer;
        margin-top: 15px;
    }
    button:hover { background: #0047b3; }
    .output {
        margin-top: 20px;
        background: #eef5ff;
        padding: 15px;
        border-radius: 10px;
    }
</style>
</head>

<body>

<div class="container">
    <h2>Employee Attendance System</h2>

    <label>Employee ID</label>
    <input id="empId">

    <label>Date</label>
    <input id="date" type="date">

    <label>Check-In Time (HH:MM)</label>
    <input id="checkIn" placeholder="09:30">

    <label>Check-Out Time (HH:MM)</label>
    <input id="checkOut" placeholder="18:45">

    <label>Break Start (optional)</label>
    <input id="breakStart" placeholder="13:00">

    <label>Break End (optional)</label>
    <input id="breakEnd" placeholder="13:45">

    <label>Overtime Approved?</label>
    <input id="overtime" type="checkbox"> Yes

    <button onclick="processAttendanceUI()">Process Attendance</button>

    <div id="result" class="output"></div>
</div>

<script>
// Convert HH:MM to minutes
function timeToMinutes(value) {
    if (!value) throw new Error("Missing time value");
    const parts = value.split(":");
    if (parts.length !== 2) throw new Error("Invalid time format");

    const h = Number(parts[0]);
    const m = Number(parts[1]);
    if (isNaN(h) || isNaN(m)) throw new Error("Invalid numeric time");

    return h * 60 + m;
}

function processAttendanceUI() {
    const data = {
        employeeId: document.getElementById("empId").value,
        date: document.getElementById("date").value,
        checkIn: document.getElementById("checkIn").value,
        checkOut: document.getElementById("checkOut").value,
        breakStart: document.getElementById("breakStart").value,
        breakEnd: document.getElementById("breakEnd").value,
        overtimeApproved: document.getElementById("overtime").checked
    };

    let summary = {
        employeeId: data.employeeId,
        date: data.date,
        status: "error",
        totalWorkingMinutes: 0,
        overtimeMinutes: 0,
        note: "",
        errorMessage: null
    };

    try {
        // Missing check-in/out
        if (!data.checkIn || !data.checkOut) {
            summary.status = "incomplete";
            summary.note = "Missing check-in or check-out";
        } else {
            const checkInMin = timeToMinutes(data.checkIn);
            const checkOutMin = timeToMinutes(data.checkOut);
            let totalMinutes = checkOutMin - checkInMin;

            if (totalMinutes < 0) {
                summary.status = "invalid";
                summary.note = "Check-out is earlier than check-in";
            } else {
                // Handle breaks
                let breakMin = 0;
                if (data.breakStart) {
                    if (data.breakEnd) {
                        breakMin = timeToMinutes(data.breakEnd) - timeToMinutes(data.breakStart);
                        if (breakMin < 0) breakMin = 30; 
                    } else {
                        breakMin = 30; // default
                    }
                }

                let workingMin = totalMinutes - breakMin;
                if (workingMin < 0) {
                    summary.status = "invalid";
                    summary.note = "Negative working minutes";
                } else {
                    summary.status = "complete";
                    summary.totalWorkingMinutes = workingMin;
                    summary.note = "Successfully calculated";

                    if (data.overtimeApproved && workingMin > 480) {
                        summary.overtimeMinutes = workingMin - 480;
                    }
                }
            }
        }
    } catch (err) {
        summary.status = "error";
        summary.errorMessage = err.message;
    }
    finally {
        document.getElementById("result").innerHTML = `
            <h3>ðŸ“Œ Attendance Summary</h3>
            <p><b>Employee ID:</b> ${summary.employeeId}</p>
            <p><b>Date:</b> ${summary.date}</p>
            <p><b>Status:</b> ${summary.status}</p>
            <p><b>Total Working Minutes:</b> ${summary.totalWorkingMinutes}</p>
            <p><b>Overtime Minutes:</b> ${summary.overtimeMinutes}</p>
            <p><b>Note:</b> ${summary.note}</p>
            <p><b>Error (if any):</b> ${summary.errorMessage || "None"}</p>
            <hr>
            <p style="color:green;"><b>âœ” Attendance processed successfully.</b></p>
        `;
    }
}
</script>

</body>
</html>
